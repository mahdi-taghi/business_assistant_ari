# راهنمای جامع تست‌ها

این مستندات توضیح کاملی از سیستم تست پروژه فرانت‌اند ارائه می‌دهد.

## 📁 ساختار تست‌ها

```
tests/
├── unit/                    # تست‌های واحد
│   ├── components/          # تست‌های کامپوننت‌ها
│   │   └── button.test.jsx  # تست کامپوننت Button
│   └── utils/               # تست‌های توابع کمکی
│       ├── index.test.js    # تست توابع utility اصلی
│       └── textDirection.test.js # تست تشخیص جهت متن
├── integration/             # تست‌های integration (آینده)
├── e2e/                     # تست‌های end-to-end (آینده)
└── helpers/                 # ابزارها و helper های تست
    ├── test-utils.js        # ابزارهای اصلی تست
    └── test-utils.test.js   # تست ابزارهای تست
```

## 🧪 انواع تست‌ها

### 1. تست‌های واحد (Unit Tests)

#### Button Component Tests
**فایل:** `tests/unit/components/button.test.jsx`

**هدف:** تست کامپوننت Button و تمام ویژگی‌های آن

**تست‌های موجود:**
- ✅ **رندر پایه**: تست رندر با props پیش‌فرض
- ✅ **انواع مختلف**: تست variant های مختلف (outline, ghost, destructive, success, warning)
- ✅ **اندازه‌ها**: تست اندازه‌های مختلف (sm, default, lg, xl)
- ✅ **تعاملات**: تست رویدادهای کلیک
- ✅ **حالت غیرفعال**: تست disabled state
- ✅ **سفارشی‌سازی**: تست className و props اضافی
- ✅ **دسترسی‌پذیری**: تست ویژگی‌های accessibility

**کاربرد:**
- اطمینان از عملکرد صحیح کامپوننت Button
- تست تمام variant ها و اندازه‌ها
- بررسی تعاملات کاربر
- اطمینان از دسترسی‌پذیری

#### Utility Functions Tests
**فایل:** `tests/unit/utils/index.test.js`

**هدف:** تست توابع کمکی اصلی پروژه

**تست‌های موجود:**
- ✅ **createPageUrl**: تولید URL صفحات
- ✅ **isAdminUser**: تشخیص کاربر ادمین
- ✅ **parseMaybeJson**: تجزیه JSON با مدیریت خطا
- ✅ **formatTime**: فرمت‌بندی زمان
- ✅ **cn**: ترکیب نام کلاس‌ها

**کاربرد:**
- اطمینان از عملکرد صحیح توابع کمکی
- تست مدیریت خطا
- بررسی edge cases
- اطمینان از سازگاری با انواع مختلف ورودی

#### Text Direction Tests
**فایل:** `tests/unit/utils/textDirection.test.js`

**هدف:** تست تشخیص جهت متن برای پشتیبانی از RTL/LTR

**تست‌های موجود:**
- ✅ **متن فارسی**: تشخیص RTL برای متن فارسی
- ✅ **متن عربی**: تشخیص RTL برای متن عربی
- ✅ **متن انگلیسی**: تشخیص LTR برای متن انگلیسی
- ✅ **متن ترکیبی**: تشخیص جهت برای متن‌های ترکیبی
- ✅ **متن خالی**: مدیریت متن خالی
- ✅ **اعداد و نمادها**: مدیریت اعداد و نمادها
- ✅ **فاصله و علائم نگارشی**: مدیریت فاصله و علائم
- ✅ **متن عبری**: پشتیبانی از عبری
- ✅ **ایموجی**: مدیریت ایموجی‌ها
- ✅ **عملکرد**: تست متن‌های طولانی
- ✅ **Unicode**: مدیریت کاراکترهای Unicode
- ✅ **اسکریپت‌های ترکیبی**: مدیریت اسکریپت‌های مختلف

**کاربرد:**
- پشتیبانی کامل از زبان‌های RTL (فارسی، عربی، عبری)
- تشخیص خودکار جهت متن
- بهبود تجربه کاربری برای کاربران فارسی‌زبان
- پشتیبانی از متن‌های چندزبانه

### 2. Helper Tests
**فایل:** `tests/helpers/test-utils.test.js`

**هدف:** تست ابزارها و helper های تست

**تست‌های موجود:**
- ✅ **Custom Render**: تست تابع رندر سفارشی
- ✅ **Mock Data**: تست داده‌های شبیه‌سازی شده
- ✅ **Utility Functions**: تست توابع کمکی تست

**کاربرد:**
- اطمینان از عملکرد صحیح ابزارهای تست
- تست mock data ها
- اطمینان از صحت helper functions

## 🚀 اجرای تست‌ها

### دستورات اصلی

```bash
# اجرای همه تست‌ها
npm run test

# اجرای تست‌ها در حالت watch
npm run test:watch

# اجرای تست‌ها با گزارش پوشش
npm run test:coverage

# اجرای تست‌ها برای CI
npm run test:ci
```

### دستورات دسته‌بندی شده

```bash
# تست‌های واحد
npm run test:unit

# تست‌های کامپوننت‌ها
npm run test:components

# تست‌های utility functions
npm run test:utils

# تست‌های helpers
npm run test:helpers

# تست‌های integration (آینده)
npm run test:integration
```

## 📊 آمار فعلی تست‌ها

```
✅ 4 Test Suites Passed
✅ 65 Tests Passed
✅ 0 Tests Failed
✅ 100% Success Rate
```

### تفکیک تست‌ها:

- **Button Component**: 10 تست
- **Utility Functions**: 25 تست
- **Text Direction**: 14 تست
- **Test Helpers**: 16 تست

## 🎯 کاربردهای تست‌ها

### 1. اطمینان از کیفیت کد
- تست تمام عملکردهای اصلی
- بررسی edge cases
- اطمینان از عدم وجود باگ

### 2. پشتیبانی از توسعه
- تست‌های خودکار در CI/CD
- تشخیص سریع مشکلات
- اطمینان از عدم شکستن کد موجود

### 3. مستندات زنده
- تست‌ها به عنوان مستندات کد عمل می‌کنند
- نشان‌دهنده نحوه استفاده از کامپوننت‌ها
- مثال‌های عملی از کاربردها

### 4. پشتیبانی از RTL
- تست‌های جامع برای پشتیبانی از زبان‌های RTL
- اطمینان از نمایش صحیح متن فارسی/عربی
- بهبود تجربه کاربری

## 🔧 ابزارهای تست

### Mock Data
- **mockUser**: داده‌های کاربر عادی
- **mockAdminUser**: داده‌های کاربر ادمین
- **mockChat**: داده‌های جلسه چت
- **mockUserMessage**: پیام کاربر
- **mockAIMessage**: پیام AI
- **mockSystemMessage**: پیام سیستم

### Helper Functions
- **customRender**: تابع رندر سفارشی
- **waitForCondition**: انتظار برای شرط
- **createMockEvent**: ایجاد رویداد شبیه‌سازی شده

## 📈 Coverage

هدف ما دستیابی به پوشش تست 80% است. در حال حاضر:

- **Utility Functions**: 100% پوشش
- **Text Direction**: 100% پوشش
- **Button Component**: 100% پوشش

## 🚀 آینده

### تست‌های برنامه‌ریزی شده:
- [ ] تست‌های Context (AuthContext, ThemeContext)
- [ ] تست‌های Custom Hooks
- [ ] تست‌های Integration
- [ ] تست‌های E2E با Playwright
- [ ] تست‌های Performance
- [ ] تست‌های Accessibility

### بهبودهای آینده:
- [ ] افزایش پوشش تست
- [ ] تست‌های Visual Regression
- [ ] تست‌های Mobile
- [ ] تست‌های Cross-browser

## 📝 نکات مهم

1. **همیشه تست‌ها را قبل از commit اجرا کنید**
2. **از `npm run test:watch` برای توسعه استفاده کنید**
3. **تست‌های جدید برای هر feature جدید بنویسید**
4. **Mock data ها را برای تست‌های واقعی‌تر به‌روزرسانی کنید**
5. **تست‌های RTL را برای پشتیبانی بهتر از فارسی بهبود دهید**

## 🎉 نتیجه

سیستم تست فعلی:
- ✅ **کاملاً کار می‌کند**
- ✅ **ساختار منظم دارد**
- ✅ **مستندات کامل دارد**
- ✅ **آماده توسعه است**
- ✅ **پشتیبانی کامل از RTL**

**تست‌ها آماده استفاده و توسعه هستند!** 🚀
